
## Shell?
사용자와 리눅스 커널 사이에서 중재자 역할을 하는 소프트웨어.
기본적으로 제공되는 배시셸은 유닉스의 전통적인 셸인 본셸(최초의 셸)과 호환성을 유지

## Shell의 기능

### 명령어 해석기 기능
사용자와 커널 사이에서 명령을 해석하여 전달하는 `Interpreter`와 `Translator` 기능
셸은 사용자가 입력한 명령이나 파일에서 읽어 들인 명령을 해석하고 적절한 프로그램을 실행한다. 명령이 셸 자체 `내장 명령`인 경우 특별한 추가 작업 없이 바로 실행되고, 아니라면 셸은 자식 프로세스를 만들고 자식 프로세스가 명령을 실행하도록 한다. 이때 부모인 셸은 `대기 상태`가 되며, 자식 프로세스가 실행을 종료하면 셸의 `대기 상태`가 해제된다.

#### 프로그래밍 기능
셸의 프로그래밍 기능을 이용하면 여러 명령을 사용하여 반복적으로 수행하는 작업을 하나의 프로그램으로 만들 수 있다. 이렇게 작성된 셸 프로그램을 `셸 스크립트`라고 부른다.

#### 사용자 환경 설정 기능
사용자 별 환경을 설정할 수 있도록 초기화 파일 기능 제공. 사용자가 로그인할 때 이 초기화 파일이 실행되어 사용자별로 특성에 맞게 초기 환경을 설정할 수 있다.
- 명령을 찾아오는 경로 설정
- 파일과 디렉터리 생성 시 적용할 기본 권한 설정
- 다양한 환경변수 설정

---

## Shell의 종류

#### 본셸(sh)
최초의 셸로, 대부분 유닉스 기반 운영체제에서 사용되다가 현재는 배시셸이나 콘셸로 심볼릭 링크가 되어있다. 
(CentOS에서 본셸의 경로를 확인해보면 배시셸과 심볼릭 링크로 연결되어 있다.)
```sh
ls -l /bin/sh
lrwxrwxrwx. 1 root root 4 .... /bin/sh -> bash
```

#### C셸(csh)
본셸의 기능을 확장한 것으로, 본셸에는 없던 앨리어스나 히스토리 같은 사용자 편의 기능 포함.
처리 속도가 느린 단점.

#### 콘셸(ksh)
C셸과 달리 본셸과의 호환성을 유지할 뿐 아니라 히스토리, 앨리어스 등 C셸의 특징도 모두 제공하면서 처리 속도도 빠르다는 장점이 있다. CentOS에서 콘셸을 사용하기 위해서는 별도로 설치해야 한다.

#### 배시셸(bash)
배시셸은 GPL을 따르는 공개 소프트웨어로서 리눅스의 기본 셸로 제공되고 있다.
배시셸의 명령인 bash는 Bourne Again Shell의 약자로 본셸을 업그레이드 했음을 나타낸다.

---

## 셸 지정 및 변경

![](images/linux/chsh.png)

시스템에 저장된 사용자 정보를 확인하면 현재 사용 중인 셸의 종류를 알 수 있다. 사용자 정보를 가지고 있는 파일 `/etc/passwd`에서 특정 사용자의 정보를 `grep` 명령어를 통해 확인 가능하다. 

### chsh
- 사용자 로그인 셸을 변경한다
- 현재 바꿀 수 있는 셸의 종류는 `/etc/shells` 파일에 지정되어 있다
- chsh \[옵션\] \[사용자명\]
- 옵션
	- -s {shell}: 지정하는 셸(절대 경로)로 로그인 셸을 바꾼다.
	- -l: `/etc/shells` 파일에 지정된 셸을 출력한다

---

## 입출력 방향 변경

#### 파일 디스크립터(file descriptor)
리눅스에서는 장치도 파일로 관리한다. 셸은 작업 중 필요한 파일에 일련번호를 붙여 관리하며 이를 `파일 디스크립터`라고 한다.

#### 표준 입출력 장치의 파일 디스크립터
- stdin(0): 표준 입력 -> 키보드
- stdout(1): 표준 출력 -> 모니터
- stderr(2): 표준 오류 -> 모니터

#### 출력 리다이렉션 
- `명령 1> 파일명` 또는 `명령 > 파일명`
	- 지정한 파일명이 없으면 파일을 생성하고, 존재하면 파일 내용이 덮어쓰기
	- 지정한 파일을 1번 파일(stdout)로 간주하겠다는 의미
	- 즉, 표준 출력이 파일로 바뀌는 것을 의미 (1은 생략 가능)
- `명령 >> 파일명`
	- 지정한 파일명이 없으면 파일을 생성하고, 존재하면 파일의 끝에 내용 추가

#### 오류 리다이렉션
- `명령 2> 파일명`
	- 표준 출력과 표준 오류는 다르게 관리되고 있기 때문에 오류 메세지를 저장하기 위해 지정


**표준 출력과 표준 오류를 한번에 리다이렉션하기**
```bash
ls . /abc > ls.out 2> ls.err
```

**표준 출력과 표준 오류를 한 파일로 리다이렉션하기**
```bash
ls . /abc > ls.out 2>&1
```

#### 입력 리다이렉션
- `명령 0< 파일명` 또는 `명령 < 파일명`
	- 표준 입력 장치 파일을 리다이렉션하는 기능
	- ex) `cat 파일명` 명령어는 `<`를 생략한 것
		- {파일명} 파일을 읽어들여 표준 출력(모니터)